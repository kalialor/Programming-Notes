"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("three"),r=require("react"),o=require("react-dom/client"),n=require("@react-three/fiber"),s=require("react-merge-refs");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var c=l(e),a=i(t),f=i(r),u=i(o),d=l(s);const h=f.createContext(null);function p(){return f.useContext(h)}const m=f.forwardRef((({children:e},t)=>{const r=f.useRef(null),o=p(),{width:s,height:l}=n.useThree((e=>e.viewport));return n.useFrame((()=>{r.current.position.x=o.horizontal?-s*(o.pages-1)*o.offset:0,r.current.position.y=o.horizontal?0:l*(o.pages-1)*o.offset})),f.createElement("group",{ref:d.default([t,r])},e)})),v=f.forwardRef((({children:e,style:t,...r},o)=>{const s=p(),l=f.useRef(null),{width:i,height:a}=n.useThree((e=>e.size)),m=f.useContext(n.context),v=f.useMemo((()=>u.createRoot(s.fixed)),[s.fixed]);return n.useFrame((()=>{s.delta>s.eps&&(l.current.style.transform=`translate3d(${s.horizontal?-i*(s.pages-1)*s.offset:0}px,${s.horizontal?0:a*(s.pages-1)*-s.offset}px,0)`)})),v.render(f.createElement("div",c.default({ref:d.default([o,l]),style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),f.createElement(h.Provider,{value:s},f.createElement(n.context.Provider,{value:m},e)))),null})),y=f.forwardRef((({html:e,...t},r)=>{const o=e?v:m;return f.createElement(o,c.default({ref:r},t))}));exports.Scroll=y,exports.ScrollControls=function({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:o,pages:s=1,distance:l=1,damping:i=4,style:c={},children:u}){const{get:d,setEvents:p,gl:m,size:v,invalidate:y,events:g}=n.useThree(),[w]=f.useState((()=>document.createElement("div"))),[x]=f.useState((()=>document.createElement("div"))),[E]=f.useState((()=>document.createElement("div"))),b=m.domElement.parentNode,z=f.useRef(0),C=f.useMemo((()=>{const t={el:w,eps:e,fill:x,fixed:E,horizontal:o,damping:i,offset:0,delta:0,scroll:z,pages:s,range(e,t,r=0){const o=e-r,n=o+t+2*r;return this.offset<o?0:this.offset>n?1:(this.offset-o)/(n-o)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){const o=e-r,n=o+t+2*r;return this.offset>=o&&this.offset<=n}};return t}),[e,i,o,s]);f.useEffect((()=>{w.style.position="absolute",w.style.width="100%",w.style.height="100%",w.style[o?"overflowX":"overflowY"]="auto",w.style[o?"overflowY":"overflowX"]="hidden",w.style.top="0px",w.style.left="0px";for(const e in c)w.style[e]=c[e];E.style.position="sticky",E.style.top="0px",E.style.left="0px",E.style.width="100%",E.style.height="100%",E.style.overflow="hidden",w.appendChild(E),x.style.height=o?"100%":s*l*100+"%",x.style.width=o?s*l*100+"%":"100%",x.style.pointerEvents="none",w.appendChild(x),b.appendChild(w),w[o?"scrollLeft":"scrollTop"]=1;const e=g.connected||m.domElement;requestAnimationFrame((()=>null==g.connect?void 0:g.connect(w)));const t=d().events.compute;return p({compute(e,t){const{left:r,top:o}=b.getBoundingClientRect(),n=e.clientX-r,s=e.clientY-o;t.pointer.set(n/t.size.width*2-1,-s/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{b.removeChild(w),p({compute:t}),null==g.connect||g.connect(e)}}),[s,l,o,w,x,E,b]),f.useEffect((()=>{if(g.connected===w){const e=v[o?"width":"height"],n=w[o?"scrollWidth":"scrollHeight"],s=n-e;let l=0,i=!0,c=!0;const a=()=>{if(t&&!c&&(y(),l=w[o?"scrollLeft":"scrollTop"],z.current=l/s,r)){if(!i)if(l>=s){const e=1-C.offset;w[o?"scrollLeft":"scrollTop"]=1,z.current=C.offset=-e,i=!0}else if(l<=0){const e=1+C.offset;w[o?"scrollLeft":"scrollTop"]=n,z.current=C.offset=e,i=!0}i&&setTimeout((()=>i=!1),40)}};w.addEventListener("scroll",a,{passive:!0}),requestAnimationFrame((()=>c=!1));const f=e=>w.scrollLeft+=e.deltaY/2;return o&&w.addEventListener("wheel",f,{passive:!0}),()=>{w.removeEventListener("scroll",a),o&&w.removeEventListener("wheel",f)}}}),[w,g,v,r,C,y,o,t]);let L=0;return n.useFrame(((t,r)=>{C.offset=a.MathUtils.damp(L=C.offset,z.current,i,r),C.delta=a.MathUtils.damp(C.delta,Math.abs(L-C.offset),i,r),C.delta>e&&y()})),f.createElement(h.Provider,{value:C},u)},exports.useScroll=p;
